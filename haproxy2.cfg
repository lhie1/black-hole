global
        maxconn 10240
defaults
        log     global
        mode    tcp
        option  dontlognull
        option  redispatch
        option  abortonclose
        timeout connect 5000
        timeout client  50000
        timeout server  50000
        timeout check   10000
frontend ss-in1
        bind    *:152
        bind    *:153
        bind    *:156
        bind    *:30000-40000
        default_backend ss-out1
backend ss-out1
        balance source
        option tcp-check
        tcp-check connect
        tcp-check send GET\ /generate_204\ HTTP/1.1\r\n
        tcp-check send Host:\ client3.google.com\r\n
        tcp-check send User-Agent:\ curl/7.54.0\r\n
        tcp-check send Accept:\ */*\r\n
        tcp-check send \r\n
        tcp-check expect rstring ^HTTP/1.1\ 204
        server  server1 cname1:170 check
        server  server2 cname2:170 check